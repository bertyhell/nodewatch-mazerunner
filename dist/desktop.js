!function(e){var r={};function t(n){if(r[n])return r[n].exports;var a=r[n]={i:n,l:!1,exports:{}};return e[n].call(a.exports,a,a.exports,t),a.l=!0,a.exports}t.m=e,t.c=r,t.d=function(e,r,n){t.o(e,r)||Object.defineProperty(e,r,{enumerable:!0,get:n})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,r){if(1&r&&(e=t(e)),8&r)return e;if(4&r&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(t.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&r&&"string"!=typeof e)for(var a in e)t.d(n,a,function(r){return e[r]}.bind(null,a));return n},t.n=function(e){var r=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(r,"a",r),r},t.o=function(e,r){return Object.prototype.hasOwnProperty.call(e,r)},t.p="",t(t.s=2)}([function(e,r,t){"use strict";t.d(r,"a",(function(){return n})),t.d(r,"b",(function(){return a})),t.d(r,"f",(function(){return o})),t.d(r,"g",(function(){return l})),t.d(r,"d",(function(){return i})),t.d(r,"e",(function(){return c})),t.d(r,"c",(function(){return f}));(new Date).getTime();function n(e){return(e+360)%360}function a(e){return Math.cos(e/180*Math.PI)}function o(e){return Math.sin(e/180*Math.PI)}function l(e){return Math.tan(e/180*Math.PI)}function i(e,r,t,n){return(t-e)*(t-e)+(n-r)*(n-r)}function c(e,r){return!(r.x>=0&&r.x<e[0].length&&r.y>=0&&r.y<e.length)}function u(e,r){return[{x:r.x-2,y:r.y},{x:r.x,y:r.y-2},{x:r.x+2,y:r.y},{x:r.x,y:r.y+2}].filter((function(r){return!c(e,r)&&-1===e[r.y][r.x]}))}function f(e,r){for(var t=new Array(r),n=0;n<r;n++){t[n]=new Array(e);for(var a=0;a<e;a++)t[n][a]=n%2==0||a%2==0?1:-1}var o,l,i,c=[],f={x:1,y:1};for(t[f.y][f.x]=0,c.push(f);c.length;)if((o=u(t,f=c.pop())).length){c.push(f);var y=o[(l=0,i=o.length-1,Math.floor(Math.random()*(i-l+1)+l))];t[(y.y+f.y)/2][(y.x+f.x)/2]=0,t[y.y][y.x]=0,c.push(y)}return t[1][1]=2,t[r-2][e-2]=3,t}},function(e,r,t){"use strict";t.d(r,"a",(function(){return h}));var n,a,o,l=t(0),i=8,c=Object(l.c)(7,7),u=1===c[1][2]?90:0,f={mazeWidth:3,mazeHeight:3,screenWidth:240,screenHeight:160,viewAngleWidth:70,angleStep:7,playerStepSize:.1,mazeHorCells:7,mazeVerCells:7,playerX:1.5,playerY:1.5,maze:c,playerAngle:u,startGame:function(e){},stopGame:function(){}},y=!0;function d(e,r,t){for(var n,a,o,i,u,y,d,p,g,h,s,b,v,x,M,m,w,j,O=Math.floor(e/90),T=0;!n||!a;)s=2===O||3===O,n||(o||(i=s?Math.floor(f.playerY):Math.floor(f.playerY)+1,o=f.playerX-(f.playerY-i)/Object(l.g)(e)),0===T||d||(p=s?-1:1,d=1/Object(l.g)(e)),v=o+(d||0)*T*(s?-1:1),x=i+(p||0)*T,M={x:Math.floor(v),y:Math.floor(x)+(s?-1:0)},Object(l.e)(c,M)||1===c[M.y][M.x]?(r&&t.drawDebugPixel(v,x),n={x:v,y:x}):r&&t.drawDebugPixel(v,x,"#FF0000")),b=0===O||3===O,a||(u||(u=b?Math.floor(f.playerX)+1:Math.floor(f.playerX),y=f.playerY-(f.playerX-u)*Object(l.g)(e)),0===T||g||(g=b?1:-1,h=Math.abs(Object(l.g)(e))*(s?-1:1)),m=u+(g||0)*T,w=y+(h||0)*T,j={x:Math.floor(m)+(b?0:-1),y:Math.floor(w)},Object(l.e)(c,j)||1===c[j.y][j.x]?(r&&t.drawDebugPixel(m,w),a={x:m,y:w}):r&&t.drawDebugPixel(m,w,"#FF0000")),T++;var B=Object(l.d)(f.playerX,f.playerY,n.x,n.y)<Object(l.d)(f.playerX,f.playerY,a.x,a.y)?n:a;if(r&&t.drawDebugPixel(B.x,B.y,"#00FF00"),t.drawDebugLine(f.playerX,f.playerY,B.x,B.y),!B)throw new Error("intersection is null");return B}function p(e,r){return 1===c[Math.floor(r)][Math.floor(e)]}function g(e,r){var t=f.playerX+e,n=f.playerY+r;return p(t,n)&&p(t=f.playerX,n=f.playerY+r)&&p(t=f.playerX+e,n=f.playerY)?void 0:(f.playerX=t,void(f.playerY=n))}f.startGame=function(e){y=!0,function e(r){r.BTN4.read()&&(console.log("left"),f.playerAngle=Object(l.a)(f.playerAngle-f.angleStep));r.BTN5.read()&&(console.log("right"),f.playerAngle=Object(l.a)(f.playerAngle+f.angleStep));var t,u,p,h,s;r.BTN1.read()&&(console.log("forward"),t=Math.floor(f.playerAngle/90),u=2===t||3===t,p=3===t||0===t,h=Math.abs(Object(l.b)(f.playerAngle)*f.playerStepSize)*(p?1:-1),s=Math.abs(Object(l.f)(f.playerAngle)*f.playerStepSize)*(u?-1:1),g(h,s));r.BTN2.read()&&(console.log("backward"),t=Math.floor(f.playerAngle/90),u=2===t||3===t,p=3===t||0===t,h=Math.abs(Object(l.b)(f.playerAngle)*f.playerStepSize)*(p?-1:1),s=Math.abs(Object(l.f)(f.playerAngle)*f.playerStepSize)*(u?1:-1),g(h,s));if(!y)return;n===f.playerX&&a===f.playerY&&o===f.playerAngle||(r.clear(),function(e){e.drawDebugGrid(c);for(var r=Object(l.a)(f.playerAngle-f.viewAngleWidth/2),t=f.viewAngleWidth/f.screenWidth,n=0;n<f.screenWidth;n+=i){var a=Object(l.a)(r+t*n),o=d(a,0===n||n>=f.screenWidth-1,e),u=Math.sqrt(Object(l.d)(f.playerX,f.playerY,o.x,o.y))*Object(l.b)(Object(l.a)(a-f.playerAngle)),y=f.screenHeight/u;e.drawPixel(n,Math.round((f.screenHeight-y)/2)),e.drawPixel(n,Math.round((f.screenHeight-y)/2+y))}}(r),r.flip());n=f.playerX,a=f.playerY,o=f.playerAngle,setTimeout((function(){return e(r)}),50)}(e)},f.stopGame=function(){y=!1};var h=f},function(e,r,t){"use strict";t.r(r);var n=t(1),a=(t(0),20),o={BTN1:{name:"up",code:38,bangleVar:"BTN1",active:!1},BTN2:{name:"down",code:40,bangleVar:"BTN2",active:!1},BTN3:{name:"menu",code:9,bangleVar:"BTN3",active:!1},BTN4:{name:"left",code:37,bangleVar:"BTN4",active:!1},BTN5:{name:"right",code:39,bangleVar:"BTN5",active:!1}};[{prop:"keyup",active:!1},{prop:"keydown",active:!0}].forEach((function(e){document.addEventListener(e.prop,(function(r){Object.keys(o).forEach((function(t){(r.which||r.keyCode)===o[t].code&&(o[t].active=e.active)}))}))}));var l,i={BTN1:{read:function(){return o.BTN1.active}},BTN2:{read:function(){return o.BTN2.active}},BTN3:{read:function(){return o.BTN3.active}},BTN4:{read:function(){return o.BTN4.active}},BTN5:{read:function(){return o.BTN5.active}},drawPixel:c,drawVerticalLine:function(e,r,t){for(var n=r;n<=t;n++)c(e,n)},clear:function(){l.fillStyle="#EEEEEE",l.fillRect(0,0,n.a.screenWidth,n.a.screenHeight),l.fillStyle="#000000"},flip:function(){},drawDebugGrid:function(){},drawDebugLine:function(){},drawDebugPixel:function(){}};window.onload=function(){var e,r=document.getElementById("canvas");r?(r.width=n.a.screenWidth,r.height=n.a.screenHeight,(e=r.getContext("2d"))?l=e:console.error("Failed to get the 2d canvas context")):console.error("Failed to find canvas element");n.a.startGame(i),console.log("starting maze runner")};n.a.mazeHorCells,n.a.mazeVerCells;function c(e,r){e>=0&&e<n.a.screenWidth&&r>=0&&r<n.a.screenHeight&&(l.fillStyle="#000000",l.fillRect(e,r,1,1))}}]);
//# sourceMappingURL=desktop.js.map