!function(e){var t={};function r(n){if(t[n])return t[n].exports;var a=t[n]={i:n,l:!1,exports:{}};return e[n].call(a.exports,a,a.exports,r),a.l=!0,a.exports}r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)r.d(n,a,function(t){return e[t]}.bind(null,a));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=3)}([function(e,t,r){"use strict";(function(e){r.d(t,"f",(function(){return a})),r.d(t,"a",(function(){return o})),r.d(t,"b",(function(){return i})),r.d(t,"g",(function(){return l})),r.d(t,"h",(function(){return c})),r.d(t,"d",(function(){return u})),r.d(t,"e",(function(){return f})),r.d(t,"c",(function(){return d}));var n=(new Date).getTime();function a(t){var r=Math.floor((new Date).getTime()-n);console.log((t||"free memory")+"; "+r+"; "+e.memory().free)}function o(e){return(e+360)%360}function i(e){return Math.cos(e/180*Math.PI)}function l(e){return Math.sin(e/180*Math.PI)}function c(e){return Math.tan(e/180*Math.PI)}function u(e,t,r,n){return(r-e)*(r-e)+(n-t)*(n-t)}function f(e,t){return!(t.x>=0&&t.x<e[0].length&&t.y>=0&&t.y<e.length)}function y(e,t){return[{x:t.x-2,y:t.y},{x:t.x,y:t.y-2},{x:t.x+2,y:t.y},{x:t.x,y:t.y+2}].filter((function(t){return!f(e,t)&&-1===e[t.y][t.x]}))}function d(e,t){for(var r=new Array(t),n=0;n<t;n++){r[n]=new Array(e);for(var a=0;a<e;a++)r[n][a]=n%2==0||a%2==0?1:-1}var o,i,l,c=[],u={x:1,y:1};for(r[u.y][u.x]=0,c.push(u);c.length;)if((o=y(r,u=c.pop())).length){c.push(u);var f=o[(i=0,l=o.length-1,Math.floor(Math.random()*(l-i+1)+i))];r[(f.y+u.y)/2][(f.x+u.x)/2]=0,r[f.y][f.x]=0,c.push(f)}return r[1][1]=2,r[t-2][e-2]=3,r}}).call(this,r(2))},function(e,t,r){"use strict";r.d(t,"a",(function(){return s}));var n=r(0);Object(n.f)("before maze");var a=Object(n.c)(7,7);Object(n.f)("after maze");var o,i,l,c=1===a[1][2]?90:0,u={mazeWidth:3,mazeHeight:3,screenWidth:240,screenHeight:160,viewAngleWidth:70,angleStep:7,playerStepSize:.1,mazeHorCells:7,mazeVerCells:7,playerX:1.5,playerY:1.5,maze:a,playerAngle:c,startGame:function(e){},stopGame:function(){}},f=!0;function y(e,t,r){for(var o,i,l,c,f,y,d,p,s,h,g,b,v,m,T,w,x,M,O=Math.floor(e/90),j=0;!o||!i;)g=2===O||3===O,o||(l||(c=g?Math.floor(u.playerY):Math.floor(u.playerY)+1,l=u.playerX-(u.playerY-c)/Object(n.h)(e)),0===j||d||(p=g?-1:1,d=1/Object(n.h)(e)),v=l+(d||0)*j*(g?-1:1),m=c+(p||0)*j,T={x:Math.floor(v),y:Math.floor(m)+(g?-1:0)},Object(n.e)(a,T)||1===a[T.y][T.x]?(t&&r.drawDebugPixel(v,m),o={x:v,y:m}):t&&r.drawDebugPixel(v,m,"#FF0000")),b=0===O||3===O,i||(f||(f=b?Math.floor(u.playerX)+1:Math.floor(u.playerX),y=u.playerY-(u.playerX-f)*Object(n.h)(e)),0===j||s||(s=b?1:-1,h=Math.abs(Object(n.h)(e))*(g?-1:1)),w=f+(s||0)*j,x=y+(h||0)*j,M={x:Math.floor(w)+(b?0:-1),y:Math.floor(x)},Object(n.e)(a,M)||1===a[M.y][M.x]?(t&&r.drawDebugPixel(w,x),i={x:w,y:x}):t&&r.drawDebugPixel(w,x,"#FF0000")),j++;var B=Object(n.d)(u.playerX,u.playerY,o.x,o.y)<Object(n.d)(u.playerX,u.playerY,i.x,i.y)?o:i;if(t&&r.drawDebugPixel(B.x,B.y,"#00FF00"),r.drawDebugLine(u.playerX,u.playerY,B.x,B.y),!B)throw new Error("intersection is null");return B}function d(e,t){return 1===a[Math.floor(t)][Math.floor(e)]}function p(e,t){var r=u.playerX+e,n=u.playerY+t;return d(r,n)&&d(r=u.playerX,n=u.playerY+t)&&d(r=u.playerX+e,n=u.playerY)?void 0:(u.playerX=r,void(u.playerY=n))}u.startGame=function(e){f=!0,function e(t){t.BTN4.read()&&(console.log("left"),u.playerAngle=Object(n.a)(u.playerAngle-u.angleStep));t.BTN5.read()&&(console.log("right"),u.playerAngle=Object(n.a)(u.playerAngle+u.angleStep));var r,c,d,s,h;t.BTN1.read()&&(console.log("forward"),r=Math.floor(u.playerAngle/90),c=2===r||3===r,d=3===r||0===r,s=Math.abs(Object(n.b)(u.playerAngle)*u.playerStepSize)*(d?1:-1),h=Math.abs(Object(n.g)(u.playerAngle)*u.playerStepSize)*(c?-1:1),p(s,h));t.BTN2.read()&&(console.log("backward"),r=Math.floor(u.playerAngle/90),c=2===r||3===r,d=3===r||0===r,s=Math.abs(Object(n.b)(u.playerAngle)*u.playerStepSize)*(d?-1:1),h=Math.abs(Object(n.g)(u.playerAngle)*u.playerStepSize)*(c?1:-1),p(s,h));if(!f)return;o===u.playerX&&i===u.playerY&&l===u.playerAngle||(t.clear(),function(e){e.drawDebugGrid(a);for(var t=Object(n.a)(u.playerAngle-u.viewAngleWidth/2),r=u.viewAngleWidth/u.screenWidth,o=0;o<u.screenWidth;o+=1){var i=Object(n.a)(t+r*o),l=y(i,0===o||o>=u.screenWidth-1,e),c=Math.sqrt(Object(n.d)(u.playerX,u.playerY,l.x,l.y))*Object(n.b)(Object(n.a)(i-u.playerAngle)),f=u.screenHeight/c;e.drawPixel(o,Math.round((u.screenHeight-f)/2)),e.drawPixel(o,Math.round((u.screenHeight-f)/2+f))}}(t),t.flip());o=u.playerX,i=u.playerY,l=u.playerAngle,setTimeout((function(){return e(t)}),50)}(e)},u.stopGame=function(){f=!1};var s=u;Object(n.f)("after engine loaded")},function(e,t){var r,n,a=e.exports={};function o(){throw new Error("setTimeout has not been defined")}function i(){throw new Error("clearTimeout has not been defined")}function l(e){if(r===setTimeout)return setTimeout(e,0);if((r===o||!r)&&setTimeout)return r=setTimeout,setTimeout(e,0);try{return r(e,0)}catch(t){try{return r.call(null,e,0)}catch(t){return r.call(this,e,0)}}}!function(){try{r="function"==typeof setTimeout?setTimeout:o}catch(e){r=o}try{n="function"==typeof clearTimeout?clearTimeout:i}catch(e){n=i}}();var c,u=[],f=!1,y=-1;function d(){f&&c&&(f=!1,c.length?u=c.concat(u):y=-1,u.length&&p())}function p(){if(!f){var e=l(d);f=!0;for(var t=u.length;t;){for(c=u,u=[];++y<t;)c&&c[y].run();y=-1,t=u.length}c=null,f=!1,function(e){if(n===clearTimeout)return clearTimeout(e);if((n===i||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(e);try{n(e)}catch(t){try{return n.call(null,e)}catch(t){return n.call(this,e)}}}(e)}}function s(e,t){this.fun=e,this.array=t}function h(){}a.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];u.push(new s(e,t)),1!==u.length||f||l(p)},s.prototype.run=function(){this.fun.apply(null,this.array)},a.title="browser",a.browser=!0,a.env={},a.argv=[],a.version="",a.versions={},a.on=h,a.addListener=h,a.once=h,a.off=h,a.removeListener=h,a.removeAllListeners=h,a.emit=h,a.prependListener=h,a.prependOnceListener=h,a.listeners=function(e){return[]},a.binding=function(e){throw new Error("process.binding is not supported")},a.cwd=function(){return"/"},a.chdir=function(e){throw new Error("process.chdir is not supported")},a.umask=function(){return 0}},function(e,t,r){"use strict";r.r(t);var n=r(1),a=(r(0),20),o={BTN1:{name:"up",code:38,bangleVar:"BTN1",active:!1},BTN2:{name:"down",code:40,bangleVar:"BTN2",active:!1},BTN3:{name:"menu",code:9,bangleVar:"BTN3",active:!1},BTN4:{name:"left",code:37,bangleVar:"BTN4",active:!1},BTN5:{name:"right",code:39,bangleVar:"BTN5",active:!1}};[{prop:"keyup",active:!1},{prop:"keydown",active:!0}].forEach((function(e){document.addEventListener(e.prop,(function(t){Object.keys(o).forEach((function(r){(t.which||t.keyCode)===o[r].code&&(o[r].active=e.active)}))}))}));var i,l={BTN1:{read:function(){return o.BTN1.active}},BTN2:{read:function(){return o.BTN2.active}},BTN3:{read:function(){return o.BTN3.active}},BTN4:{read:function(){return o.BTN4.active}},BTN5:{read:function(){return o.BTN5.active}},drawPixel:c,drawVerticalLine:function(e,t,r){for(var n=t;n<=r;n++)c(e,n)},clear:function(){i.fillStyle="#EEEEEE",i.fillRect(0,0,n.a.screenWidth,n.a.screenHeight),i.fillStyle="#000000"},flip:function(){},drawDebugGrid:function(){},drawDebugLine:function(){},drawDebugPixel:function(){}};window.onload=function(){var e,t=document.getElementById("canvas");t?(t.width=n.a.screenWidth,t.height=n.a.screenHeight,(e=t.getContext("2d"))?i=e:console.error("Failed to get the 2d canvas context")):console.error("Failed to find canvas element");n.a.startGame(l),console.log("starting maze runner")};n.a.mazeHorCells,n.a.mazeVerCells;function c(e,t){e>=0&&e<n.a.screenWidth&&t>=0&&t<n.a.screenHeight&&(i.fillStyle="#000000",i.fillRect(e,t,1,1))}}]);
//# sourceMappingURL=desktop.js.map