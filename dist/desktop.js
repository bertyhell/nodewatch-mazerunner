!function(e){var r={};function t(n){if(r[n])return r[n].exports;var a=r[n]={i:n,l:!1,exports:{}};return e[n].call(a.exports,a,a.exports,t),a.l=!0,a.exports}t.m=e,t.c=r,t.d=function(e,r,n){t.o(e,r)||Object.defineProperty(e,r,{enumerable:!0,get:n})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,r){if(1&r&&(e=t(e)),8&r)return e;if(4&r&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(t.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&r&&"string"!=typeof e)for(var a in e)t.d(n,a,function(r){return e[r]}.bind(null,a));return n},t.n=function(e){var r=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(r,"a",r),r},t.o=function(e,r){return Object.prototype.hasOwnProperty.call(e,r)},t.p="",t(t.s=2)}([function(e,r,t){"use strict";function n(e){return(e+360)%360}function a(e){return Math.cos(e/180*Math.PI)}function o(e){return Math.sin(e/180*Math.PI)}function l(e){return Math.tan(e/180*Math.PI)}function i(e,r,t,n){return(t-e)*(t-e)+(n-r)*(n-r)}function c(e,r){return!(r.x>=0&&r.x<e[0].length&&r.y>=0&&r.y<e.length)}function u(e,r){return[{x:r.x-2,y:r.y},{x:r.x,y:r.y-2},{x:r.x+2,y:r.y},{x:r.x,y:r.y+2}].filter((function(r){return!c(e,r)&&-1===e[r.y][r.x]}))}function f(e,r){for(var t=new Array(r),n=0;n<r;n++){t[n]=new Array(e);for(var a=0;a<e;a++)t[n][a]=n%2==0||a%2==0?1:-1}var o,l,i,c=[],f={x:1,y:1};for(t[f.y][f.x]=0,c.push(f);c.length;)if((o=u(t,f=c.pop())).length){c.push(f);var y=o[(l=0,i=o.length-1,Math.floor(Math.random()*(i-l+1)+l))];t[(y.y+f.y)/2][(y.x+f.x)/2]=0,t[y.y][y.x]=0,c.push(y)}return t[1][1]=2,t[r-2][e-2]=3,t}t.d(r,"a",(function(){return n})),t.d(r,"b",(function(){return a})),t.d(r,"f",(function(){return o})),t.d(r,"g",(function(){return l})),t.d(r,"d",(function(){return i})),t.d(r,"e",(function(){return c})),t.d(r,"c",(function(){return f}))},function(e,r,t){"use strict";t.d(r,"a",(function(){return s}));var n,a,o,l=t(0),i=Object(l.c)(7,7),c=1===i[1][2]?90:0,u={mazeWidth:3,mazeHeight:3,screenWidth:240,screenHeight:160,viewAngleWidth:70,angleStep:7,playerStepSize:.1,mazeHorCells:7,mazeVerCells:7,playerX:1.5,playerY:1.5,maze:i,playerAngle:c,startGame:function(e){},stopGame:function(){}},f={"0000":!1,"0001":!0,"0010":!0,"0011":!1,"0100":!0,"0101":!1,"0110":!1,"0111":!0,1e3:!0,1001:!0,1010:!1,1011:!0,1100:!1,1101:!0,1110:!0,1111:!1},y=!0;function d(e,r,t){for(var n,a,o,c,f,y,d,p,h,s,g,b,v,x,M,w,m,j,O=Math.floor(e/90),T=0;!n||!a;)g=2===O||3===O,n||(o||(c=g?Math.floor(u.playerY):Math.floor(u.playerY)+1,o=u.playerX-(u.playerY-c)/Object(l.g)(e)),0===T||d||(p=g?-1:1,d=1/Object(l.g)(e)),v=o+(d||0)*T*(g?-1:1),x=c+(p||0)*T,M={x:Math.floor(v),y:Math.floor(x)+(g?-1:0)},Object(l.e)(i,M)||1===i[M.y][M.x]?(r&&t.drawDebugPixel(v,x),n={x:v,y:x}):r&&t.drawDebugPixel(v,x,"#FF0000")),b=0===O||3===O,a||(f||(f=b?Math.floor(u.playerX)+1:Math.floor(u.playerX),y=u.playerY-(u.playerX-f)*Object(l.g)(e)),0===T||h||(h=b?1:-1,s=Math.abs(Object(l.g)(e))*(g?-1:1)),w=f+(h||0)*T,m=y+(s||0)*T,j={x:Math.floor(w)+(b?0:-1),y:Math.floor(m)},Object(l.e)(i,j)||1===i[j.y][j.x]?(r&&t.drawDebugPixel(w,m),a={x:w,y:m}):r&&t.drawDebugPixel(w,m,"#FF0000")),T++;var B=Object(l.d)(u.playerX,u.playerY,n.x,n.y)<Object(l.d)(u.playerX,u.playerY,a.x,a.y)?n:a;if(r&&t.drawDebugPixel(B.x,B.y,"#00FF00"),t.drawDebugLine(u.playerX,u.playerY,B.x,B.y),!B)throw new Error("intersection is null");return B}function p(e,r){return 1===i[Math.floor(r)][Math.floor(e)]}function h(e,r){var t=u.playerX+e,n=u.playerY+r;return p(t,n)&&p(t=u.playerX,n=u.playerY+r)&&p(t=u.playerX+e,n=u.playerY)?void 0:(u.playerX=t,void(u.playerY=n))}u.startGame=function(e){y=!0,function e(r){r.BTN4.read()&&(u.playerAngle=Object(l.a)(u.playerAngle-u.angleStep));r.BTN5.read()&&(u.playerAngle=Object(l.a)(u.playerAngle+u.angleStep));var t,c,p,s,g;r.BTN1.read()&&(t=Math.floor(u.playerAngle/90),c=2===t||3===t,p=3===t||0===t,s=Math.abs(Object(l.b)(u.playerAngle)*u.playerStepSize)*(p?1:-1),g=Math.abs(Object(l.f)(u.playerAngle)*u.playerStepSize)*(c?-1:1),h(s,g));r.BTN2.read()&&(t=Math.floor(u.playerAngle/90),c=2===t||3===t,p=3===t||0===t,s=Math.abs(Object(l.b)(u.playerAngle)*u.playerStepSize)*(p?-1:1),g=Math.abs(Object(l.f)(u.playerAngle)*u.playerStepSize)*(c?1:-1),h(s,g));if(!y)return;n===u.playerX&&a===u.playerY&&o===u.playerAngle||(r.clear(),function(e){e.drawDebugGrid(i);for(var r=Object(l.a)(u.playerAngle-u.viewAngleWidth/2),t=u.viewAngleWidth/u.screenWidth,n=[],a=0;a<u.screenWidth;a+=1){var o=Object(l.a)(r+t*a),c=d(o,0===a||a>=u.screenWidth-1,e),y=Math.sqrt(Object(l.d)(u.playerX,u.playerY,c.x,c.y))*Object(l.b)(Object(l.a)(o-u.playerAngle));n.push({angle:o,collision:c,distance:y,shouldDrawWall:!1})}var p={};n.forEach((function(e){var r=Math.round(e.collision.x),t=Math.round(e.collision.y);p[r+";"+t]={x:r,y:t}}));var h=[];Object.keys(p).forEach((function(e){var r=p[e],t=i[r.y-1][r.x-1],n=i[r.y-1][r.x],a=i[r.y][r.x-1],o=i[r.y][r.x];f[(1===t?"1":"0")+(1===n?"1":"0")+(1===a?"1":"0")+(1===o?"1":"0")]&&h.push(r)})),h.forEach((function(e){var r=1e5,t=0;n.forEach((function(n,a){var o=Math.abs(e.x-n.collision.x)+Math.abs(e.y-n.collision.y);o<r&&(t=a,r=o)})),n[t].shouldDrawWall=!0})),n.forEach((function(r,t){var n=u.screenHeight/r.distance;r.shouldDrawWall?e.drawVerticalLine(t,Math.round((u.screenHeight-n)/2),Math.round((u.screenHeight-n)/2+n)):(e.drawPixel(t,Math.round((u.screenHeight-n)/2)),e.drawPixel(t,Math.round((u.screenHeight-n)/2+n)))}))}(r),r.flip());n=u.playerX,a=u.playerY,o=u.playerAngle,setTimeout((function(){return e(r)}),50)}(e)},u.stopGame=function(){y=!1};var s=u},function(e,r,t){"use strict";t.r(r);var n=t(1),a=(t(0),20),o={BTN1:{name:"up",code:38,bangleVar:"BTN1",active:!1},BTN2:{name:"down",code:40,bangleVar:"BTN2",active:!1},BTN3:{name:"menu",code:9,bangleVar:"BTN3",active:!1},BTN4:{name:"left",code:37,bangleVar:"BTN4",active:!1},BTN5:{name:"right",code:39,bangleVar:"BTN5",active:!1}};[{prop:"keyup",active:!1},{prop:"keydown",active:!0}].forEach((function(e){document.addEventListener(e.prop,(function(r){Object.keys(o).forEach((function(t){(r.which||r.keyCode)===o[t].code&&(o[t].active=e.active)}))}))}));var l,i={BTN1:{read:function(){return o.BTN1.active}},BTN2:{read:function(){return o.BTN2.active}},BTN3:{read:function(){return o.BTN3.active}},BTN4:{read:function(){return o.BTN4.active}},BTN5:{read:function(){return o.BTN5.active}},drawPixel:c,drawVerticalLine:function(e,r,t){for(var n=r;n<=t;n++)c(e,n)},clear:function(){l.fillStyle="#EEEEEE",l.fillRect(0,0,n.a.screenWidth,n.a.screenHeight),l.fillStyle="#000000"},flip:function(){},drawDebugGrid:function(){},drawDebugLine:function(){},drawDebugPixel:function(){}};window.onload=function(){var e,r=document.getElementById("canvas");r?(r.width=n.a.screenWidth,r.height=n.a.screenHeight,(e=r.getContext("2d"))?l=e:console.error("Failed to get the 2d canvas context")):console.error("Failed to find canvas element");n.a.startGame(i),console.log("starting maze runner")};n.a.mazeHorCells,n.a.mazeVerCells;function c(e,r){e>=0&&e<n.a.screenWidth&&r>=0&&r<n.a.screenHeight&&(l.fillStyle="#000000",l.fillRect(e,r,1,1))}}]);
//# sourceMappingURL=desktop.js.map